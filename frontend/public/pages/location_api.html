<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Full Location Demo</title>
  <style>
    /* Basic page styling */
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      padding: 30px;
    }

    /* Card container for UI */
    .card {
      max-width: 500px;
      margin: auto;
      background: #fff;
      padding: 25px;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    h2 {
      text-align: center;
      color: #333;
    }

    /* Button styling */
    button {
      width: 100%;
      padding: 12px;
      margin-top: 15px;
      font-size: 16px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    button:hover {
      background: #0056b3;
    }

    /* Result and status boxes */
    .result, .status {
      margin-top: 20px;
      padding: 10px;
      border-radius: 4px;
      background: #eef3f8;
    }

    .status {
      font-style: italic;
      color: #555;
    }
  </style>
</head>
<body>

<!-- Main interactive card -->
<div class="card">
  <h2>Full Location Finder</h2>

  <!-- Button to trigger location fetch -->
  <button id="locationBtn">Get My Full Location</button>

  <!-- Status messages (permission, loading, errors) -->
  <div class="status" id="status">Click the button to get your location.</div>

  <!-- Display coordinates and full address -->
  <div class="result" id="result"></div>
</div>

<script>
/* ========== DOM Elements ========== */
const button = document.getElementById("locationBtn");  // Button element
const statusText = document.getElementById("status");  // Status box
const resultBox = document.getElementById("result");   // Result box

/* ========== Event Listener ========== */
button.addEventListener("click", getLocation);  // Run getLocation() when button clicked

/* ========== Get User Location (Browser Geolocation API) ========== */
function getLocation() {
  // Clear previous result
  resultBox.innerHTML = "";
  statusText.innerText = "Requesting location permission...";

  // Check if browser supports Geolocation
  if (!navigator.geolocation) {
    statusText.innerText = "Geolocation not supported by your browser.";
    return;
  }

  // Request current position
  navigator.geolocation.getCurrentPosition(
    showPosition,    // Success callback
    handleError,     // Error callback
    {
      enableHighAccuracy: true,  // Use GPS if available for better precision
      timeout: 10000,            // Timeout after 10 seconds
      maximumAge: 0              // Do not use cached position
    }
  );
}

/* ========== Success Callback ========== */
function showPosition(position) {
  const lat = position.coords.latitude;   // Latitude
  const lon = position.coords.longitude;  // Longitude

  statusText.innerText = "Location retrieved successfully!";

  // ===== Reverse Geocoding: Convert coordinates to human-readable address =====
  // Using OpenStreetMap Nominatim API (free)
  fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`)
    .then(response => response.json())  // Convert response to JSON
    .then(data => {
      const address = data.address;     // Extract address object from response
      resultBox.innerHTML = `
        <strong>Latitude:</strong> ${lat}<br>
        <strong>Longitude:</strong> ${lon}<br>
        <strong>Country:</strong> ${address.country || "N/A"}<br>
        <strong>State:</strong> ${address.state || "N/A"}<br>
        <strong>City:</strong> ${address.city || address.town || address.village || "N/A"}<br>
        <strong>Street:</strong> ${address.road || "N/A"}<br>
        <strong>Postcode:</strong> ${address.postcode || "N/A"}
      `;
    })
    .catch(error => {
      // Handle errors from API request
      resultBox.innerHTML = "Unable to fetch address details.";
      console.error(error);
    });
}

/* ========== Error Callback ========== */
function handleError(error) {
  switch (error.code) {
    case error.PERMISSION_DENIED:
      statusText.innerText = "Permission denied by user.";
      break;
    case error.POSITION_UNAVAILABLE:
      statusText.innerText = "Location info unavailable.";
      break;
    case error.TIMEOUT:
      statusText.innerText = "Location request timed out.";
      break;
    default:
      statusText.innerText = "An unknown error occurred.";
  }
}
</script>

</body>
</html>